<!DOCTYPE html>
<html lang="fr">
{% load static %}
<head>
  <meta charset="UTF-8">
  <title>Bon de Livraison — Duplicata</title>
  <style>
    @page { size: A4; margin: 10mm; }
    body { font-family: 'Segoe UI', Roboto, Arial, sans-serif; font-size: 11px; color: #1f2937; line-height: 1.3; }

    /* En-tête moderne compatible PDF (table-based) */
    .header-table { width: 100%; border-collapse: collapse; margin-bottom: 6px; }
    .header-table td { vertical-align: middle; padding: 2px 0; }
    .logo-cell { width: 120px; }
    .logo-cell img { max-height: 45px; max-width: 110px; }
    .title-cell { text-align: center; }
    .title { font-weight: 700; font-size: 16px; letter-spacing: 0.3px; color: #111827; }
    .dup { display: block; font-size: 10px; color: #6b7280; margin-top: 1px; }
    .plant-cell { width: 140px; text-align: right; font-size: 10px; color: #4b5563; }
    .sitrad-logo { width: 80px; text-align: right; }
    .sitrad-logo img { max-height: 35px; max-width: 75px; }
    .divider { height: 0; border-top: 1.5px solid #111827; margin: 4px 0 8px; }

    /* Sections visuelles */
    .section-header { background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); border: 1px solid #cbd5e1; padding: 4px 8px; font-weight: 700; font-size: 10px; color: #1e293b; text-transform: uppercase; letter-spacing: 0.4px; }
    
    /* Tableau principal */
    table.bl { width: 100%; border-collapse: collapse; box-shadow: 0 1px 2px rgba(0,0,0,0.08); }
    table.bl td { border: 1px solid #d0d7de; padding: 6px 8px; vertical-align: top; background: #ffffff; }
    table.bl td:nth-child(odd) { background: #fafbfc; }
    .label { font-size: 9px; color: #374151; display: block; margin-bottom: 3px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.2px; }
    .value { font-size: 10px; color: #111827; font-weight: 500; }
    .sig-label { font-size: 9px; color: #4b5563; }
    .sig-line { height: 0; border-top: 1px solid #d0d7de; margin-top: 18px; }

    /* Pied de page */
    .footer { margin-top: 8px; font-size: 9px; color: #6b7280; line-height: 1.2; }
  </style>
</head>
<body>
  <table class="header-table">
    <tr>
      <td class="title-cell">
        <div class="title">BON DE LIVRAISON</div>
      </td>
      <td class="sitrad-logo">
        <img src="https://scontent-lis1-1.xx.fbcdn.net/v/t1.6435-9/74614812_103019241141950_842139745537490944_n.jpg?_nc_cat=106&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeEjzfjeu-OLGdtqFuxaOMg4ZxmDo1FBoBNnGYOjUUGgEyOvkhEBgloSk9Ee5KDtxqd8DIG9JUcMf855VIfB8YUc&_nc_ohc=WK6pa2q1-3gQ7kNvwHtrECN&_nc_oc=AdmWLKrnvEbQbgm2IO9U52oVj848asj3XVgIGxk-o3wPtJ6o706EG8sb2nbjiTmbguM&_nc_zt=23&_nc_ht=scontent-lis1-1.xx&_nc_gid=SslPV1DcZt354SX1Cl1K1g&oh=00_AfdPu2R4c44i_xNiR5hCHGBAY7XXKYHLJE2j0PVeisixNg&oe=690EFE6B" alt="Sitrad Logo">
      </td>
    </tr>
  </table>
  <div class="divider"></div>

  <table class="bl">
    <tr>
      <td colspan="5" class="section-header">INFORMATIONS COMMANDE</td>
    </tr>
    <tr>
      <td colspan="3">
        <span class="label">Date</span>
        <span class="value">{{ bl.date|date:"d/m/Y" }}</span><br>
        <span class="label">Client</span>
        <span class="value">{{ client.name }}</span><br>
        <span class="label">Chantier</span>
        <span class="value">{{ bl.site }}</span>
      </td>
      <td colspan="2">
        <span class="label">Bon N°</span>
        <span class="value">{{ bl.number }}</span><br>
        <span class="label">Centrale</span>
        <span class="value">{{ plant.name }}</span><br>
        <span class="label">Code Client</span>
        <span class="value">{{ client.code }}</span>
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">Quantité Livrée</span>
        <span class="value">{{ concrete.volume_m3 }} m³</span>
      </td>
      <td>
        <span class="label">N° de Commande</span>
        <span class="value">{{ bl.command_number }}</span>
      </td>
      <td>
        <span class="label">Qté Commandée</span>
        <span class="value">{{ bl.ordered_quantity_m3 }} m³</span>
      </td>
      <td>
        <span class="label">Qté Cumulée</span>
        <span class="value">{{ bl.cumulative_quantity_m3 }} m³</span>
      </td>
      <td>
        <span class="label">Code Béton</span>
        <span class="value">{{ concrete.code }}</span>
      </td>
    </tr>
    <tr>
      <td colspan="5" class="section-header">CARACTÉRISTIQUES BÉTON</td>
    </tr>
    <tr>
      <td colspan="5">
        <span class="label">Désignation</span>
        <span class="value">{{ concrete.designation|default:"MICRO-BETON" }}</span>
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">Classe Résistance</span>
        <span class="value">{{ concrete.resistance_class }}</span>
      </td>
      <td>
        <span class="label">Classe Exposition</span>
        <span class="value">{{ concrete.exposure_class }}</span>
      </td>
      <td>
        <span class="label">Classe Consistance</span>
        <span class="value">{{ concrete.consistency }}</span>
      </td>
      <td>
        <span class="label">Classe Chlorure</span>
        <span class="value">{{ concrete.chloride_class }}</span>
      </td>
      <td>
        <span class="label">D max</span>
        <span class="value">{{ concrete.dmax_mm }} mm</span>
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">Type Ciment</span>
        <span class="value">{{ concrete.cement_type }}</span>
      </td>
      <td>
        <span class="label">Type Adjuvant</span>
        <span class="value">{{ concrete.additive_type }}</span>
      </td>
      <td>
        <span class="label">Rapport E/C</span>
        <span class="value">{{ concrete.ec_ratio }}</span>
      </td>
      <td>
        <span class="label">Teneur Air</span>
        <span class="value">{{ concrete.air_content_percent }} %</span>
      </td>
      <td>
        <span class="label">Température</span>
        <span class="value">{{ quality.temperature_c }} °C</span>
      </td>
    </tr>
    <tr>
      <td colspan="3">
        <span class="label">Teneur Ciment</span>
        <span class="value">{{ concrete.cement_content_kg_per_m3 }} kg/m³</span>
      </td>
      <td colspan="2">
        <span class="label">Masse Volumique</span>
        <span class="value">{{ concrete.density_kg_per_m3 }} kg/m³</span>
      </td>
    </tr>
    <tr>
      <td colspan="5" class="section-header">INFORMATIONS TRANSPORT</td>
    </tr>
    <tr>
      <td>
        <span class="label">Transporteur</span>
        <span class="value">{{ transport.carrier }}</span>
      </td>
      <td>
        <span class="label">Matricule Camion</span>
        <span class="value">{{ transport.mixer_number }}</span>
      </td>
      <td>
        <span class="label">Nom Chauffeur</span>
        <span class="value">{{ transport.driver }}</span>
      </td>
      <td>
        <span class="label">Pompe</span>
        <span class="value">{{ transport.services }}</span>
      </td>
      <td>
        <span class="label">Référence</span>
        <span class="value">{{ transport.reference }}</span>
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">H. Première</span>
        <span class="value">{{ transport.first_time }}</span>
      </td>
      <td>
        <span class="label">H. Arrivée</span>
        <span class="value">{{ transport.arrival_time }}</span>
      </td>
      <td>
        <span class="label">H. Début</span>
        <span class="value">{{ transport.start_time }}</span>
      </td>
      <td>
        <span class="label">H. Fin</span>
        <span class="value">{{ transport.end_time }}</span>
      </td>
      <td>
        <span class="label">Retour Centrale</span>
        <span class="value">{{ transport.return_time }}</span>
      </td>
    </tr>
    <tr>
      <td colspan="3" style="height:70px;">
        <span class="label">Notes</span>
        <span class="value">{{ bl.notes }}</span>
      </td>
      <td colspan="2" style="height:70px;">
        <span class="label">Réception</span>
        <div class="sig-label">Visa & cachet du client</div>
        <div class="sig-line"></div>
      </td>
    </tr>
  </table>

  <div class="footer">
    * Béton à propriété spécifique (BPS) ou à composition prescrite (BCP) conformes à la norme NM10.1.008<br>
    Il est strictement interdit à notre chauffeur de rajouter de l’eau ou d’autres ingrédients.<br>
    La durée de mise en œuvre du béton ne dépasse pas 120 min.
  </div>
</body>
</html>
