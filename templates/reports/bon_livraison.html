<!DOCTYPE html>
<html lang="fr">
{% load static %}
<head>
  <meta charset="UTF-8">
  <title>Bon de Livraison — Duplicata</title>
  <style>
    @page { size: A4; margin: 16mm; }
    body { font-family: 'Segoe UI', Roboto, Arial, sans-serif; font-size: 12px; color: #1f2937; line-height: 1.45; }

    /* En-tête moderne compatible PDF (table-based) */
    .header-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
    .header-table td { vertical-align: middle; padding: 4px 0; }
    .logo-cell { width: 140px; }
    .logo-cell img { max-height: 58px; max-width: 130px; }
    .title-cell { text-align: center; }
    .title { font-weight: 700; font-size: 18px; letter-spacing: 0.4px; color: #111827; }
    .dup { display: block; font-size: 11px; color: #6b7280; margin-top: 2px; }
    .plant-cell { width: 160px; text-align: right; font-size: 11px; color: #4b5563; }
    .divider { height: 0; border-top: 2px solid #111827; margin: 6px 0 12px; }

    /* Tableau principal */
    table.bl { width: 100%; border-collapse: collapse; }
    table.bl td { border: 1px solid #d0d7de; padding: 8px 10px; vertical-align: top; }
    .label { font-size: 10.5px; color: #374151; display: block; margin-bottom: 6px; font-weight: 600; letter-spacing: 0.2px; }
    .sig-label { font-size: 10.5px; color: #4b5563; }
    .sig-line { height: 0; border-top: 1px solid #d0d7de; margin-top: 26px; }

    /* Pied de page */
    .footer { margin-top: 14px; font-size: 10px; color: #6b7280; }
  </style>
</head>
<body>
  <table class="header-table">
    <tr>
      <td class="logo-cell">
        <img src="{% static 'images/logo.png' %}" alt="Logo" />
      </td>
      <td class="title-cell">
        <div class="title">BON DE LIVRAISON</div>
        <span class="dup">DUPLICATA</span>
      </td>
      <td class="plant-cell">{{ plant.name }}</td>
    </tr>
  </table>
  <div class="divider"></div>

  <table class="bl">
    <tr>
      <td colspan="3">
        <span class="label">DATE</span>
        {{ bl.date|date:"d/m/Y" }}<br>
        <span class="label">CLIENT</span>
        {{ client.name }}<br>
        <span class="label">CHANTIER</span>
        {{ bl.site }}
      </td>
      <td colspan="2">
        <span class="label">BON N°</span>
        {{ bl.number }}<br>
        <span class="label">CENTRALE</span>
        {{ plant.name }}<br>
        <span class="label">CODE CLIENT</span>
        {{ client.code }}
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">QUANTITÉ LIVRÉE</span>
        {{ concrete.volume_m3 }} m³
      </td>
      <td>
        <span class="label">N° DE COMMANDE</span>
        {{ bl.command_number }}
      </td>
      <td>
        <span class="label">QTÉ COMMANDÉE</span>
        {{ bl.ordered_quantity_m3 }} m³
      </td>
      <td>
        <span class="label">QTÉ CUMULÉE</span>
        {{ bl.cumulative_quantity_m3 }} m³
      </td>
      <td>
        <span class="label">CODE BÉTON</span>
        {{ concrete.code }}
      </td>
    </tr>
    <tr>
      <td colspan="5">
        <span class="label">DESIGNATION :</span>
        {{ concrete.designation|default:"MICRO-BETON" }}
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">CLASSE DE RÉSISTANCE</span>
        {{ concrete.resistance_class }}
      </td>
      <td>
        <span class="label">CLASSE D’EXPOSITION</span>
        {{ concrete.exposure_class }}
      </td>
      <td>
        <span class="label">CLASSE DE CONSISTANCE</span>
        {{ concrete.consistency }}
      </td>
      <td>
        <span class="label">CLASSE DE TENEUR EN CHLORURE</span>
        {{ concrete.chloride_class }}
      </td>
      <td>
        <span class="label">D max</span>
        {{ concrete.dmax_mm }} mm
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">TYPE ET CLASSE DE CIMENT</span>
        {{ concrete.cement_type }}
      </td>
      <td>
        <span class="label">TYPE D’ADJUVANT</span>
        {{ concrete.additive_type }}
      </td>
      <td>
        <span class="label">RAPPORT E/C</span>
        {{ concrete.ec_ratio }}
      </td>
      <td>
        <span class="label">TENEUR EN AIR</span>
        {{ concrete.air_content_percent }} %
      </td>
      <td>
        <span class="label">TEMPÉRATURE DU BÉTON</span>
        {{ quality.temperature_c }} °C
      </td>
    </tr>
    <tr>
      <td colspan="3">
        <span class="label">TENEUR EN CIMENT</span>
        {{ concrete.cement_content_kg_per_m3 }} kg/m³
      </td>
      <td colspan="2">
        <span class="label">MASSE VOLUMIQUE</span>
        {{ concrete.density_kg_per_m3 }} kg/m³
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">TRANSPORTEUR</span>
        {{ transport.carrier }}
      </td>
      <td>
        <span class="label">MATRICULE DU CAMION</span>
        {{ transport.mixer_number }}
      </td>
      <td>
        <span class="label">NOM DU CHAUFFEUR</span>
        {{ transport.driver }}
      </td>
      <td>
        <span class="label">SERVICES</span>
        {{ transport.services }}
      </td>
      <td>
        <span class="label">RÉFÉRENCE</span>
        {{ transport.reference }}
      </td>
    </tr>
    <tr>
      <td>
        <span class="label">H. 1ERE</span>
        {{ transport.first_time }}
      </td>
      <td>
        <span class="label">H. ARRIVÉE</span>
        {{ transport.arrival_time }}
      </td>
      <td>
        <span class="label">H. DÉBUT</span>
        {{ transport.start_time }}
      </td>
      <td>
        <span class="label">H. FIN</span>
        {{ transport.end_time }}
      </td>
      <td>
        <span class="label">RETOUR CENTRALE</span>
        {{ transport.return_time }}
      </td>
    </tr>
    <tr>
      <td colspan="3" style="height:110px;">
        <span class="label">NOTES</span>
        {{ bl.notes }}
      </td>
      <td colspan="2" style="height:110px;">
        <span class="label">RÉCEPTION</span>
        <div class="sig-label">Visa & cachet du client</div>
        <div class="sig-line"></div>
      </td>
    </tr>
  </table>

  <div class="footer">
    * Béton à propriété spécifique (BPS) ou à composition prescrite (BCP) conformes à la norme NM10.1.008<br>
    Il est strictement interdit à notre chauffeur de rajouter de l’eau ou d’autres ingrédients.<br>
    La durée de mise en œuvre du béton ne dépasse pas 120 min.
  </div>
</body>
</html>
